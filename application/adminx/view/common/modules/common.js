/** layuiAdmin.std-v1.2.1 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(["form","table","laydate"],function(t){var e=layui.$,a=layui.layer,r=layui.laydate,i=(layui.laytpl,layui.setter,layui.view,layui.form),n=layui.table,o=layui.admin;e.extend({isEmpty:function(t){return null===t||void 0==t||""===t}}),i.verify({equals:function(t,a){var r=e(a).attr("equalsId");if(e.isEmpty(r))return"未配置对比id";var i=e("#"+r).val();if(t!==i){var n=e(a).attr("equalsMsg");return e.isEmpty(n)&&(n="值不相等"),n}},username:[/^[a-zA-Z]{1}([a-zA-Z0-9]|[_]){2,19}$/,"用户名格式不正确!"],length:function(t,a){var r=e(a).attr("minLength"),i=e(a).attr("maxLength");return!e.isEmpty(r)&&"0"!==r&&parseInt(r)>t.length?"输入内容小于最小值:"+r:!e.isEmpty(i)&&"0"!==i&&t.length>parseInt(i)?"输入内容大于最小值:"+i:void 0},_mobile:function(t){if(""!=t&&!checkMobile(t))return"请输入正确的手机号码"},__mobile:function(t){if(!checkMobile(t))return"请输入正确的手机号码"},_url:function(t){if(""!=t&&!checkUrl(t))return"请输入正确URL格式"},__url:function(t){if(!checkUrl(t))return"请输入正确URL格式"},__username:function(t){if(!checkWordLong(t,2,8))return"请输入用户名2-8个字符"},_password:function(t){if(""!=t&&!checkWordLong(t,6,12))return"请输入密码6-12个字符"},__password:function(t){if(!checkWordLong(t,6,12))return"请输入密码6-12个字符"},__repassword:function(t){if(!checkRepassword(t))return"两次密码不同"}}),r.render({elem:".lay-date"}),e("select").each(function(){e(this).attr("default")&&e(this).val(e(this).attr("default"))}),i.render(),i.on("submit(lay-common-submit)",function(t){var r=e(t.elem).attr("iframe");return o.req({url:e(t.elem).attr("url"),data:t.field,method:"post",done:function(t){a.msg(t.msg,{offset:"15px",icon:1,time:1e3},function(){if(1==r){var e=parent.layer.getFrameIndex(window.name);parent.layer.close(e)}else""!=t.url&&void 0!=t.url&&("reload"==t.url?window.location.reload():window.location.href=t.url)})}}),e("#lay-get-vercode").length>0&&e("#lay-get-vercode").click(),!1}),getDatagridCols=function(t){var a=new Array,r=new Array,i=new Array,n=e(t).next(".fsDatagridCols");if(!e.isEmpty(n)){var o={};e.each(n.children(),function(t,i){var n=e(this),l=n.attr("type");if(!e.isEmpty(l)&&"br"==l)return a.push(r),r=new Array,o={},!0;var s=n.attr("toolbar"),c={};if(e.isEmpty(n.attr("align"))||(c.align=n.attr("align")),e.isEmpty(n.attr("fixed"))||(c.fixed=n.attr("fixed")),e.isEmpty(n.attr("style"))||(c.style=n.attr("style")),e.isEmpty(n.attr("colspan"))||(c.colspan=n.attr("colspan")),e.isEmpty(n.attr("rowspan"))||(c.rowspan=n.attr("rowspan")),e.isEmpty(s)){var u=n.attr("field"),d=n.attr("title"),m=n.attr("width"),f=n.attr("sort"),p=n.attr("templet"),h=n.attr("checkbox");e.isEmpty(l)||(c.type=l),e.isEmpty(u)||(c.field=u),e.isEmpty(d)||(c.title=d),e.isEmpty(m)||(c.width=m),e.isEmpty(f)||(c.sort=f),e.isEmpty(p)||(c.templet=p),e.isEmpty(h)||(c.checkbox=h),e.isEmpty(n.attr("LAY_CHECKED"))||(c.LAY_CHECKED=n.attr("LAY_CHECKED")),e.isEmpty(n.attr("edit"))||(c.edit=n.attr("edit")),e.isEmpty(n.attr("event"))||(c.event=n.attr("event")),r.push(c)}else{c.toolbar=s;var m=n.attr("width");e.isEmpty(m)||(c.width=m);var d=n.attr("title");e.isEmpty(d)||(c.title=d),r.push(c)}}),a.push(r)}return o.colsArr=a,o.formatArr=i,o},e(".lay-common-table").each(function(t,a){var r=getDatagridCols(a);n.render({elem:"#lay-common-table",url:e(a).attr("lay-url"),method:e(a).attr("lay-method"),cols:r.colsArr,page:!0,limit:15,limits:[10,15,20,25,30]})}),n.on("tool(lay-common-table)",function(t){var a=(t.data,e(this));if("edit"===t.event){var r=a.attr("data-tableId"),i=a.attr("url"),o=1;top.layer.open({type:2,title:e(this).attr("topTitle"),content:i,maxmin:!0,area:[e(this).attr("topWidth"),e(this).attr("topHeight")],btn:["确定"],yes:function(t,e){var a=e.find("iframe").contents().find("#lay-common-submit");a.click()},cancel:function(){o=0},end:function(){""!=r&&void 0!=r&&1==o&&n.reload(r)}})}if("view"===t.event){var i=a.attr("url");top.layer.open({type:2,title:e(this).attr("topTitle"),content:i,maxmin:!0,area:[e(this).attr("topWidth"),e(this).attr("topHeight")]})}}),i.on("submit(tools-btn-search)",function(t){var a=e(t.form).attr("tableId"),r=t.field;return n.reload(a,{where:r}),!1}),e(".layui-btn.tools-btn").on("click",function(){var t=e(this).data("type");l[t]?l[t].call(this):""});var l={action:function(){var t=e(this).attr("data-tableId"),r=e(this).attr("url"),i=e(this).attr("alert"),l=e(this).attr("alertMsg"),s=n.checkStatus(t),c=s.data;if(0===c.length)return a.msg("请选择数据");for(var u=[],d=0;d<c.length;d++)u.push(c[d].id);1==i&&""!=l?top.layer.confirm(l,function(e){o.req({url:r,data:{id:u.join(",")},method:"post",done:function(e){top.layer.msg(e.msg,{offset:"15px",icon:1,time:1e3},function(){n.reload(t)})}})}):o.req({url:r,data:{id:u.join(",")},method:"post",done:function(e){top.layer.msg(e.msg,{offset:"15px",icon:1,time:1e3},function(){n.reload(t)})}})},selectOpen:function(){var t=e(this).attr("data-tableId"),r=e(this).attr("url"),i=1,o=n.checkStatus(t),l=o.data;if(0===l.length)return a.msg("请选择数据");for(var s=[],c=0;c<l.length;c++)s.push(l[c].id);top.layer.open({type:2,title:e(this).attr("topTitle"),content:r+"?id="+s.join("-"),maxmin:!0,area:[e(this).attr("topWidth"),e(this).attr("topHeight")],btn:["确定"],yes:function(t,e){var a=e.find("iframe").contents().find("#lay-common-submit");a.click()},cancel:function(){i=0},end:function(){""!=t&&void 0!=t&&1==i&&n.reload(t)}})},add:function(){var t=e(this).attr("data-tableId"),a=e(this).attr("url"),r=1;top.layer.open({type:2,title:e(this).attr("topTitle"),content:a,maxmin:!0,area:[e(this).attr("topWidth"),e(this).attr("topHeight")],btn:["确定"],yes:function(t,e){var a=e.find("iframe").contents().find("#lay-common-submit");a.click()},cancel:function(){r=0},end:function(){""!=t&&void 0!=t&&1==r&&n.reload(t)}})},refresh:function(){var t=e(this).attr("data-tableId");n.reload(t)},url:function(){var t=e(this).attr("url");window.location.href=t},back:function(){window.history.go(-1)}};o.events.logout=function(){o.req({url:"/manage/adminx/login/signout",type:"get",data:{},done:function(t){a.msg("已退出系统",{icon:1,time:1e3},function(){location.href="/manage/adminx"})}})},t("common",{})});